task: trajectory

# CHANGE this to the directory with the 3-month preprocessed data.
# It must contain "train", "val", (and optionally "test") subfolders.
processed_dir: data/map_reduced/ # /dtu/blackhole/10/178320/preprocessed_1/final/

# Where to save the final/best checkpoint
out_dir: data/checkpoints/tptrans_full/

# Sequence setup
window: 64          # length of observed history
horizon: 12         # prediction horizon

# Full feature list in the preprocessed pickle; the model will still only
# use the first 4: [LAT, LON, SOG, COG].
features: [LAT, LON, SOG, COG, HEADING, ROT, NAV_STT, TIMESTAMP, MMSI]

model:
  name: tptrans
  d_model: 512      # latent dimension
  nhead: 8          # Transformer heads
  enc_layers: 8     # encoder depth
  dec_layers: 4     # GRU layers

# Training setup
loss: huber
optimizer: adamw

# These are what your training script reads:
lr: 0.0003          # AdamW learning rate
batch_size: 96 # 128     # was 96; 128 is safe on an A100 80GB
epochs: 25 #100                # allow enough room to converge
early_stop_patience: 8     # stop if 8 epochs pass without real improvement
early_stop_min_delta: 1e-4 # require at least 1e-4 improvement in val loss


# Extra stability knobs used in train_traj_V3.py:
huber_delta: 1.0    # SmoothL1 beta (default in code)
clip_norm: 1.0      # gradient clipping max-norm (default in code)