# configs/traj_traisformer.yaml
task: trajectory
# CHANGE TO YOUR DATA PATH
processed_dir: data/processed/map_reduced/ #/dtu/blackhole/10/178320/preprocessed_2/final/
out_dir: data/checkpoints/

window: 64
horizon: 12
start_mode: kmeans  # set to "kmeans" to enable centroid-based starting points
kmeans:
  n_clusters: 50
  samples_per_traj: 300
  max_points: 250000
  n_init: 10
  random_state: 42

model:
  name: traisformer
  d_model: 512
  nhead: 4
  enc_layers: 4 # dec_layers: 12
  dropout: 0.1

# TrAISformer loss auxiliaries
coarse_merge: 3
coarse_beta: 0.2

# Binning Resolution (Crucial for Classification)
bins:
  n_lat: 384
  n_lon: 768
  n_sog: 50
  n_cog: 72

model:
  name: traisformer
  d_model: 512
  nhead: 4
  num_layers: 4
  dropout: 0.1
  emb_lat: 128
  emb_lon: 128
  emb_sog: 64
  emb_cog: 64

loss: cross_entropy
optimizer: adamw
lr: 0.0003
batch_size: 512
epochs: 200
epoch_samples: 5

early_stop_patience: 50
early_stop_min_delta: 1e-4

wandb_group: traisformer_local_small
run_name: traisformer_small_run